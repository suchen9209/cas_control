<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CAS完美Team</title>
    <link rel="stylesheet" href="./css/index.css" type="text/css">
    <script src="./js/jquery-1.8.3.js" type="text/javascript"></script>
    <script src="./js/setting.js" type="text/javascript"></script>
</head>
<body>
    <div class="box">
        <div class="Team_con layout">
            <div class="Team_top">
                <div class="Team_logo" id="left_log">
                    <!-- <img src="img/Team_data_bg4.png" alt=""> -->
                </div>
                <div class="Team_mid">
                    <div class="vs">
                        <img src="img/Team_data_bg1.png" alt="">
                    </div>
                    <div class="score">
                        <!-- <span class="parts5">16:9</span> -->
                    </div>
                </div>
                <div class="Team_logo" id="right_log">
                    <!-- <img src="img/Team_data_bg5.png" alt=""> -->
                </div>
            </div>
            <div class="Team_bot">
                <ul>
                    <li id="rating">
                        <!-- <span class="parts4">1.25</span> -->
                        <span class="parts5">RATING</span>
                        <!-- <span class="parts6">1.26</span> -->
                    </li>
                    <li id="kill">
                        <!-- <span class="parts4">26</span> -->
                        <span class="parts5">KILLS</span>
                       <!--  <span class="parts6">15</span> -->
                    </li>
                    <li id="kd_rating">
                       <!--  <span class="parts4">1.30</span> -->
                        <span class="parts5">K/D RATING</span>
                        <!-- <span class="parts6">1.20</span> -->
                    </li>
                    <li id="awp_kill">
                        <!-- <span class="parts4">26</span> -->
                        <span class="parts5">AWP KILLS</span>
                        <!-- <span class="parts6">15</span> -->
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        $.ajax({
            type:"GET",
            url:url,
            success: function(data){
                if (data.success && data.data != null) {
                    showteam(data.data);
                }else{
                    $.getJSON(json_url,function(data){
                        showteam(data.data);
                    });
                }
            },
            error: function(){
                $.getJSON(json_url,function(data){
                    showteam(data.data);
                });
            }
        });        
        function showteam(data){
            var players =data.players;
            var ct_num = 0,t_num = 0,ct_kill = 0,t_kill = 0,ct_awp_kill=0,t_awp_kill=0;
            var ct_rating=0,t_rating=0,ct_death=0,t_death=0;
            for(var key in players){    
                var tmp_player = players[key];
                if(tmp_player.player_info.team_id == data.ct_team_id){
                    ct_num ++;
                    ct_kill += tmp_player.kill;
                    ct_awp_kill += tmp_player.sniper_kill;
                    ct_rating += parseFloat(tmp_player.rating);
                    ct_death += tmp_player.death;
                }
                if(tmp_player.player_info.team_id == data.t_team_id){
                    t_num ++;
                    t_kill += tmp_player.kill;
                    t_awp_kill += tmp_player.sniper_kill;
                    t_rating += parseFloat(tmp_player.rating);
                    t_death += tmp_player.death;
                }
            }
            $(".score").append('<span class="parts5">'+data.ct_win_times+':'+data.t_win_times+'</span>');
            $("#left_log").append('<img src="'+data.ct_team_info.logo+'" alt="">');
            $("#right_log").append('<img src="'+data.t_team_info.logo+'" alt="">');
            $("#rating").prepend('<span class="parts4">'+(ct_rating/ct_num).toFixed(2)+'</span>');
            $("#rating").append('<span class="parts6">'+(t_rating/t_num).toFixed(2)+'</span>');
            $("#kill").prepend('<span class="parts4">'+ct_kill+'</span>');
            $("#kill").append('<span class="parts6">'+t_kill+'</span>');
            $("#kd_rating").prepend('<span class="parts4">'+(ct_kill/ct_death).toFixed(2)+'</span>');
            $("#kd_rating").append('<span class="parts6">'+(t_kill/t_death).toFixed(2)+'</span>');
            $("#awp_kill").prepend('<span class="parts4">'+ct_awp_kill+'</span>');
            $("#awp_kill").append('<span class="parts6">'+t_awp_kill+'</span>');
        }

    </script>
</body>
</html>