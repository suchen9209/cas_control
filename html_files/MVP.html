<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CAS完美MVP</title>
    <link rel="stylesheet" href="./css/index.css" type="text/css">
    <script src="./js/jquery-1.8.3.js" type="text/javascript"></script>
    <script src="./js/setting.js" type="text/javascript"></script>
</head>
<body>
    <div class="box">
        <div class="MVP_con layout">
            <div class="MVP_name">
                <!-- <p class="name1">NEO</p> -->
                <!-- <p class="name2">FILLIP KUBSKI</p> -->
            </div>
            <div class="MVP_player">
                <!-- <img src="img/MVP_bg3.png" alt=""> -->
            </div>
            <ul class="MVP_parts">
                <li id="kills">
                    <span class="parts1">KILLS</span>
<!--                     <span class="parts2">17</span> -->
                </li>
                <li id="deaths">
                    <span class="parts1">DEATHS</span>
<!--                     <span class="parts2">17</span> -->
                </li>
                <li id="assists">
                    <span class="parts1">ASSISTS</span>
<!--                     <span class="parts2">17</span> -->
                </li>
                <li id="entry_kills">
                    <span class="parts1">ENTRY KILLS</span>
<!--                     <span class="parts2">17</span> -->
                </li>
                <li id="ka_ratio">
                    <span class="parts1">K/D RATIO</span>
<!--                     <span class="parts2">17</span> -->
                </li>
            </ul>
        </div>
    </div>
        <script type="text/javascript">
        const {ipcRenderer} = require('electron');
        mvp_id = ipcRenderer.sendSync('get-setting', 'mvp_id');
        $.ajax({
            type:"GET",
            url:url,
            success: function(data){
                if (data.success && data.data != null) {
                    showpmvp(data.data,mvp_id);
                }else{
                    $.getJSON(json_url,function(data){
                        showpmvp(data.data,mvp_id);
                    });
                }
            },
            error: function(){
                $.getJSON(json_url,function(data){
                    showpmvp(data.data,mvp_id);
                });
            }
        });        
        function showpmvp(data,mvp_id){
            var players = data.players;
            var mvp = players[mvp_id];
            $(".MVP_name").append('<p class="name1">'+ mvp.player_info.name +'</p>');
            var tmp_nick = mvp.player_info.name;
            if(jQuery.inArray(tmp_nick,Object.keys(real_name)) > -1){
                $(".MVP_name").append('<p class="name2">'+ eval("real_name."+tmp_nick) +'</p>');
            }
            $(".MVP_player").append('<img src="./photo/'+mvp.player_info.name+'_L.png" alt="">');

            $("#kills").append('<span class="parts2">'+ mvp.kill +'</span>');
            $("#deaths").append('<span class="parts2">'+ mvp.death +'</span>');
            $("#assists").append('<span class="parts2">'+ mvp.assist +'</span>');
            $("#entry_kills").append('<span class="parts2">'+ mvp.first_kill +'</span>');
            if(mvp.death==0){
                mvp.death=1;
            }
            $("#ka_ratio").append('<span class="parts2">'+ (mvp.kill/mvp.death).toFixed(2) +'</span>');
        }

    </script>
</body>
</html>